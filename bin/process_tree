#!/bin/bash

repo=$1
path=$2

if [[ -d repos/$path/repo ]]
then
    (cd repos/$path/repo && git pull)
else
    git clone $repo repos/$path/repo
fi

cd repos/$path/repo || exit
find . -type d -exec sh -c 'printf "%s/\n" "$0"' {} \; -or -print | grep -v /.git/ > ../files.txt
CSEARCHINDEX=../index.csearch cindex .
# node bin/build_index.js ../files.txt > ../index.lunr.json
git log > ../log.txt
git log --pretty="format:%H" --name-status > ../changes.txt
